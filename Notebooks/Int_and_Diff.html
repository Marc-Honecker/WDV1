

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Numerisches Integrieren und Differenzieren &#8212; WDV1</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/Int_and_Diff';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gewöhnliche Differential Gleichungen" href="ODEs.html" />
    <link rel="prev" title="Mittelwert, Varianz und Histogramme" href="Stats.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Vorbemerkungen zu Kurs und Skript
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="HelloWorld.html">Erste Schritte in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="IO.html">Lesen und Schreiben von Dateien</a></li>
<li class="toctree-l1"><a class="reference internal" href="Stats.html">Mittelwert, Varianz und Histogramme</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Numerisches Integrieren und Differenzieren</a></li>
<li class="toctree-l1"><a class="reference internal" href="ODEs.html">Gewöhnliche Differential Gleichungen</a></li>
<li class="toctree-l1"><a class="reference internal" href="CurveSketching.html">Kurvendiskussion und Optimierung</a></li>
<li class="toctree-l1"><a class="reference internal" href="Regression.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Complex.html">Komplexe Zahlen und Rechenregeln mit Gleitkomma-Zahlen</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/Int_and_Diff.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Numerisches Integrieren und Differenzieren</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerisches-integrieren">Numerisches Integrieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerisches-differenzieren">Numerisches Differenzieren</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ableitungen-1-ordnung">Ableitungen 1. Ordnung</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ableitungen-hoherer-ordnung">Ableitungen höherer Ordnung</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="numerisches-integrieren-und-differenzieren">
<h1>Numerisches Integrieren und Differenzieren<a class="headerlink" href="#numerisches-integrieren-und-differenzieren" title="Permalink to this heading">#</a></h1>
<p>In diesem Kapitel wollen wir uns dem numerischen Integrieren und Differenzieren widmen. Hierbei handelt es
sich um Techniken zur näherungsweisen Berechnung von bestimmten Integralen und Ableitungen. Vorallem
findet dies dann Anwendung, wenn man das Problem analytisch nur schwer lösen kann oder es zu ineffizient
ist, um das Problem analytisch zu lösen.</p>
<p>Zunächst werden wir uns um das Integrieren kümmern und danach um das Differenzieren.</p>
<section id="numerisches-integrieren">
<h2>Numerisches Integrieren<a class="headerlink" href="#numerisches-integrieren" title="Permalink to this heading">#</a></h2>
<p>Um eine Intuition zu bekommen, schauen wir uns den 1-D Fall an einem konkreten Beispiel an. Sei also
unsere Funktion <span class="math notranslate nohighlight">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span>:</p>
<div class="math notranslate nohighlight">
\[ f(x) := x^2\]</div>
<p>Visualisieren wir uns die Funktion.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># importieren der benötigten Bibliotheken</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Grenzen der Integration</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># anlegen der x-Werte in unterschiedlicher </span>
<span class="c1"># Auflösung</span>
<span class="n">ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">vlines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># wir berechnen die Funktion f(x) = x^2</span>
<span class="n">fv</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vlines</span><span class="p">]</span>
<span class="n">fx</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ab</span><span class="p">]</span>

<span class="c1"># plotten der Funktion</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">ab</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">vlines</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fv</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vlines</span><span class="p">,</span> <span class="n">fv</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/976e3dff4813794d6a242d05ec281d238e6675f3aa5e22cf5491818a88dbc027.png" src="../_images/976e3dff4813794d6a242d05ec281d238e6675f3aa5e22cf5491818a88dbc027.png" />
</div>
</div>
<p>Wie immer ist das Ziel beim Integrieren einer Funktion die Fläche unter dem Graph (möglichst genau) zu
berechnen. Und dies ist natürlich auch unser Ziel beim numerischen Integrieren.</p>
<p>Wie man hier gut erkennen kann, ist es möglich eine Funktion mit linearen Abschnitten zu approximieren
(die roten Abschnitte sind die linearen Approximationen). Man bekommt damit also eine (mehr oder weniger)
gute Representierung durch Trapeze. Somit kann man dann die Fläche unter der Funktion approximieren
mit der Formel:</p>
<div class="math notranslate nohighlight">
\[
\int\limits_a^b f(x) dx \approx \sum_a^b \frac{f(x) + f(x+\Delta x)}{2} \cdot \Delta x
\]</div>
<p>Damit haben wir eine Berechnungsformel zur approximativen Berechnung des Integrals einer Funktion.
Und diese Formel können wir auch direkt schon in Python übersetzen! Dies sieht wie folgt aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># die Grenzen</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># f(x) := x^2</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># die Schrittweite der Funktion, also das Delta x</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1"># die x Werte</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

<span class="c1"># das berechnete Integral</span>
<span class="n">Fab</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># die Hauptschleife</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vals</span><span class="p">:</span>
    <span class="c1"># linke Seite des Trapezes</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># rechte Seite des Trapezes</span>
    <span class="n">fdx</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span>
    <span class="c1"># die Fläche des Trapezes wird zur Gesamtfläche addiert</span>
    <span class="n">Fab</span> <span class="o">+=</span> <span class="p">(</span><span class="n">fx</span> <span class="o">+</span> <span class="n">fdx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Fab</span><span class="p">)</span>

<span class="c1"># analytische Lösung</span>
<span class="n">Fab</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">0</span><span class="o">**</span><span class="mi">3</span>
<span class="n">Fab</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>333.3335000000001
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>333.3333333333333
</pre></div>
</div>
</div>
</div>
<p>Wir sehen also, dass wir mit dieser (ziemlich einfachen) Berechnungsmethode sehr nahe an die
tatsächliche Lösung kommen (Größenordnung <span class="math notranslate nohighlight">\(10^{-4}\)</span>)! Natürlich hängt die Qualität des Ergebnisses signifikant von der Wahl
des <span class="math notranslate nohighlight">\(\Delta x\)</span> ab. Wählen wir dieses zu groß, approximieren wir die Funktion über einen relative
großen Bereich und damit reduziert sich auch die Genauigkeit ziemlich drastig. Als Daumenregel kann
man hier sagen, dass man <span class="math notranslate nohighlight">\(\Delta x\)</span> lieber ein wenig kleiner wählt als zu groß. Bei den heutigen
Prozessoren merkt in aller Regel auch keinen Unterschied, ob man die Funktion in 100 Bereiche
oder in 1000 diskretisiert. Leider kann man aber die Genauigkeit nicht unendlich verbessern, da man in einem Computer
nur endlich kleine Werte darstellen kann. Aber Schrittweiten von 0.01 sind auf jeden Fall nicht zu klein und in aller
Regel auch nicht zu groß.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Intuition numerische Integration</p>
<p>Der Algorithmus zur Berechnung des numerischen Integrals ist im Endeffekt eine direkte Anwendung des
Riemann Integrals, welches auch schon aus der Schule bekannt sein sollte. Denn prinzipiell ist das
Riemann Integral nichts anderes als eine unedliche Summe von Rechtecken, welche infinitisimal breit
sind. Da wir aber in einem Computer nur endliche Genauigkeit haben, müssen wir die Rechtecke (oder
hier Trapeze) breiter machen und bekommen damit nur eine (mehr oder weniger genaue) Approximation.</p>
<p>Dies ist dann auch der Grund, weshalb wir ein genaueres Ergebnis bekommen, wenn wir den Bereich in
viele kleine Bereiche unterteilen.</p>
</div>
</section>
<section id="numerisches-differenzieren">
<h2>Numerisches Differenzieren<a class="headerlink" href="#numerisches-differenzieren" title="Permalink to this heading">#</a></h2>
<section id="ableitungen-1-ordnung">
<h3>Ableitungen 1. Ordnung<a class="headerlink" href="#ableitungen-1-ordnung" title="Permalink to this heading">#</a></h3>
<p>Schauen wir uns eine Definition der Ableitung an, die ein wenig anders aussieht als die, die aus der
Schule bereits bekannt sein sollte:</p>
<div class="math notranslate nohighlight">
\[
f'(x) := \frac{f(x+h) - f(x-h)}{2h}; \;h \rightarrow 0
\]</div>
<p>Diese Formel kann man jetzt auch schon direkt wieder nutzen, um die Ableitung numerisch in einem Punkt zu berechenen.
In Python Code sieht das dann wie folgt aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unser Punkt</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># unsere Funktion</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># unser h</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="c1"># die numerische Ableitung</span>
<span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># die analytische Lösung</span>
<span class="n">df</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.00000000139778
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title"><span class="math notranslate nohighlight">\(h\)</span> vs <span class="math notranslate nohighlight">\(2h\)</span></p>
<p>Man benutzt bei der numerischen Differentation <span class="math notranslate nohighlight">\(2h\)</span> und die damit resultierenden Verschiebungen in
x-Richtung, weil man dadurch einen quadratischen Fehler in <span class="math notranslate nohighlight">\(h\)</span> bekommt. Benutzt man aber die herkömmliche Definition,
so erhält man einen Fehler in <span class="math notranslate nohighlight">\(O(h)\)</span>, was für ein <span class="math notranslate nohighlight">\(h&lt;1\)</span> in einem größeren Fehler resultiert, als die von uns
benutzte Methode. Interessierte können <a class="reference external" href="https://de.wikipedia.org/wiki/Numerische_Differentiation">hier</a> und <a class="reference external" href="http://www.tm-mathe.de/Themen/html/funnumdiff.html">hier</a> mehr über das Thema erfahren. Selbstverständlich ist dies aber nicht für die
Klausur relevant.</p>
</div>
<p>Möchte man Ableitung der Funktion über ein komplettes Intervall <span class="math notranslate nohighlight">\([a,b]\)</span> berechenen, so können wir obigen Code
ganz leicht erweitern um eine Schleife über das komplette Intervall, anstelle eines einzigen Punktes. Konkret
sieht dies dann ganz ähnlich zur Integration aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unser Intervall</span>
<span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># wir diskretisieren die Funktion wieder in </span>
<span class="c1"># 1000 Bereiche</span>
<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span>

<span class="c1"># die x Werte</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>

<span class="c1"># unsere Funktion</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># unser h</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="c1"># die numerische Ableitung</span>
<span class="k">def</span> <span class="nf">df</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>

<span class="c1"># Berechnung der Funktionswerte (nur zur Visualisierung)</span>
<span class="n">f_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vals</span><span class="p">]</span>
<span class="c1"># Berechnung der Ableitungen an allen Punkten</span>
<span class="n">df_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_vals</span><span class="p">]</span>

<span class="c1"># schauen wir uns die Ableitung an</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">df_vals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">f_vals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/306182b9e5a8ac701a10530102864053ca16f558e9ec789543dace575aea4798.png" src="../_images/306182b9e5a8ac701a10530102864053ca16f558e9ec789543dace575aea4798.png" />
</div>
</div>
<p>Wie man leicht sieht, entspricht das Ergebnis exakt unseren Erwartungen.</p>
</section>
<section id="ableitungen-hoherer-ordnung">
<h3>Ableitungen höherer Ordnung<a class="headerlink" href="#ableitungen-hoherer-ordnung" title="Permalink to this heading">#</a></h3>
<p>Wenn wir im späteren Verlauf der Vorlesung Kurvendiskussionen besprechen möchten, brauchen wir natürlich auch Ableitungen
höherer Ordnung. Für unsere Anwendungen reichen Ableitung 2. Ordnung völlig aus, weswegen wir Ableitungen höherer Ordnung
nicht betrachten werden. Für die Ableitung 2. Ordnung erhalten wir dann:</p>
<div class="math notranslate nohighlight">
\[
f''(x) \approx \frac{f(x+h) + f(x-h) - 2f(x)}{h^2}; \; h \rightarrow 0
\]</div>
<p>Diese Formel erhält man, indem man um den Punkt <span class="math notranslate nohighlight">\(x\)</span> zwei Taylor-Entwicklungen durchführt. Dies sieht wie folgt aus:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f(x+h) = f(x) + hf'(x) + \frac{h^2 f''(x)}{2} + \frac{h^3f'''(x)}{6} + O(h^4) \\
f(x-h) = f(x) - hf'(x) + \frac{h^1 f''(x)}{2} - \frac{h^3f'''(x)}{6} + O(h^4) \\
\end{split}\]</div>
<p>Addiert man diese beiden Gleichungen zusammen, so erhält man:</p>
<div class="math notranslate nohighlight">
\[
f(x+h) + f(x-h) = 2f(x) + h^2 f''(x) + O(h^2)
\]</div>
<p>Stellen wir diese Gleichung nach <span class="math notranslate nohighlight">\(f''(x)\)</span> um, so erhalten wir:</p>
<div class="math notranslate nohighlight">
\[
f''(x) = \frac{f(x+h) + f(x-h) - 2f(x)}{h^2} + O(h^2)
\]</div>
<p>Da <span class="math notranslate nohighlight">\(h\rightarrow 0\)</span>, bekommen wir mit einem Fehler der Größenordnung von <span class="math notranslate nohighlight">\(O(h^2)\)</span> eine gut Approximation. Die konkrete
Implementierung ist genau analog zur obigen Implementierung und wird deshalb dem Leser überlassen.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Stats.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mittelwert, Varianz und Histogramme</p>
      </div>
    </a>
    <a class="right-next"
       href="ODEs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gewöhnliche Differential Gleichungen</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerisches-integrieren">Numerisches Integrieren</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerisches-differenzieren">Numerisches Differenzieren</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ableitungen-1-ordnung">Ableitungen 1. Ordnung</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ableitungen-hoherer-ordnung">Ableitungen höherer Ordnung</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Chrsitian Müller, Marc Johannes Honecker und Martin H. Müser
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>